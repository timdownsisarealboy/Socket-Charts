<html>
<head>
<title> Socket Charts </title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
<script src="http://code.highcharts.com/highcharts.js"></script>
<script src="http://code.highcharts.com/modules/exporting.js"></script>
<script src="/socket.io/socket.io.js"></script>
</head>
<body>
<div id="container" style="min-width: 400px; height: 400px; margin: 0 auto"></div>
</body>
<script>
$(document).ready(function() {
    var fixed_days = ["Wed Jun 05 2013", "Thu Jun 06 2013", "Fri Jun 07 2013", "Sat Jun 08 2013", "Mon Jun 10 2013"] ;
    var counts = [4,33,10,22,10]

    $(function () {
            $('#container').highcharts({
                chart: {
                    events: {
                        load: function() {
                            var localChart = this;
                            var socket = io.connect('http://localhost');
                            socket.on('news', function (socketdata) {
                                if (socketdata.point !== undefined) {
                                    console.log('updating chart');
                                    point = localChart.series[1].data[socketdata.point];
                                    point.update(parseInt(socketdata.value)); 
                                }
                                console.log(socketdata);
                            });
                        }
                    }
                },
                title: {
                    text: 'Asset Creation Data'
                },
                xAxis: {
                    categories: fixed_days
                },
                tooltip: {
                    formatter: function() {
                        var s;
                        if (this.point.name) { // the pie chart
                            s = ''+
                                this.point.name +': '+ this.y +' fruits';
                        } else {
                            s = ''+
                                this.x  +': '+ this.y;
                        }
                        return s;
                    }
                },
                labels: {
                    items: [{
                    }]
                },
                series: [{
                    type: 'spline',
                    name: 'Assets Created',
                    data: counts, 
                    marker: {
                        lineWidth: 2,
                        lineColor: Highcharts.getOptions().colors[3],
                        fillColor: 'white'
                    }
                }]
            });
        });
});
</script>
</html>
